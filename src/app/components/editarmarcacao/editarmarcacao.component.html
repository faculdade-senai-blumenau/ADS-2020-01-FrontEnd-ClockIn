<app-nav></app-nav>
<!-- Alertas -->
<!-- Alerta Erro ao Registrar Ponto -->
<ngb-alert *ngIf="mensagemSucesso" id=alert type="success" (close)="mensagemSucesso = ''"> {{ mensagemSucesso }}
</ngb-alert>
<!-- Alerta Sucesso ao Registrar Ponto -->
<ngb-alert *ngIf="mensagemErro" id=alert type="danger" (close)="mensagemErro = ''"> {{ mensagemErro }}
</ngb-alert>
<div class="wrapper">
  <div class="main">
    <main class="content">
      <div class="container p-0">
        <div class="header pt-4 mb-3">
          <h1 class="header-title">Editar Marcações</h1>
        </div>
        <div class="row ">
          <div class="col-12 col-lg-12 col-xxl-6 pb-5">
            <div class="card flex-fill">
              <div class="card-header">
                <h4 class="card-title">Editar Marcações</h4>
                <h6 class="card-subtitle text-muted">Edição de marcações dos registros de ponto.
                </h6>
              </div>
              <div class="table-responsive table-striped text-center ">
                <div class="card-body text-center ">
                  <!--Table-->
                  <table class="table " id='TabelaEditarPonto'>
                    <thead class="thead-light ">
                      <tr>
                        <th>Data</th>
                        <th colspan="8">Horarios</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr
                        *ngFor="let ponto of listaDePontos | paginate: { itemsPerPage: 10, currentPage: paginaAtual }; let i = index">
                        <p class="text-center m-2">{{ponto.dataRegistro | date: 'dd/MM/yyyy'}}</p>
                        <td class="text-center m-2" *ngFor="let ponto of ponto.values">
                          <p data-toggle="modal" data-target="#editarMarcacao"
                            (click)="buscarRegistroPontoID(ponto.idRegistroPonto)">
                            {{ponto["horaRegistro"].split(":")[0]}}:{{ponto["horaRegistro"].split(":")[1]}}
                          </p>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
              <div class="card-footer text-center">
                <pagination-controls class="m-0" (pageChange)="paginaAtual = $event" previousLabel="Anterior"
                  nextLabel="Próximo">
                </pagination-controls>
                <button type="button" id="btnNovo" class="btn btn-primary btn float-right mr-5 mt-0" data-toggle="modal"
                  data-target="#inserirMarcacao">Novo</button>
              </div>
              <!--Table-->

              <!-- Modal Editar-->
              <div class="modal fade" id="editarMarcacao" tabindex="-1" role="dialog" aria-labelledby="editarMarcacao"
                aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h4 class="modal-title" id="exampleModalLongTitle">Editar Registro Ponto</h4>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <div class="row">
                        <div class="col-md-12 col-offset-2">
                          <div class="modal-container">
                            <div class="col-sm-12 contact-form ">
                              <form>
                                <div class="row">
                                  <div class="col-md-12 p-0">
                                    <div class="row">
                                      <div class="col-md-6 pb-2 pt-1">
                                        <label for="dataRegistro">Data Registro</label>
                                        <input [(ngModel)]="registroPonto.dataRegistro" class="form-control"
                                          id="dataRegistro" name="dataRegistro" [value]="ponto.dataRegistro" type="date"
                                          required disabled>
                                      </div>
                                      <div class="col-md-6 pb-2 pt-1">
                                        <label for="horaRegistro">Horário</label>
                                        <input [(ngModel)]="registroPonto.horaRegistro" class="form-control"
                                          id="horaRegistro" name="horaRegistro" placeholder="Horário"
                                          [value]="ponto.horaRegistro" type="time" required="true" autofocus=""
                                          minlength="5" maxlength="5">
                                      </div>
                                      <div class="col-md-12">
                                        <label for="justificaPonto">Justificativa</label>
                                        <select [(ngModel)]="registroPonto.justificaPonto"
                                          class="custom-select  form-control" id="justificaPonto" name="justificaPonto"
                                          placeholder="Justificativa" type="number" aria-controls="datatables-basic"
                                          placeholder="Selecione..." required>
                                          <option value="1">
                                            <font style="vertical-align: inherit;">
                                              <font style="vertical-align: inherit;">Esquecimento</font>
                                            </font>
                                          </option>
                                          <option value="2">
                                            <font style="vertical-align: inherit;">
                                              <font style="vertical-align: inherit;">Trabalho Externo</font>
                                            </font>
                                          </option>
                                          <option value="3">
                                            <font style="vertical-align: inherit;">
                                              <font style="vertical-align: inherit;">Sistema Indisponível</font>
                                            </font>
                                          </option>
                                        </select>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </form>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-danger" data-dismiss="modal">Cancelar</button>
                      <button type="button" class="btn btn-success" (click)="updateRegistroPonto()"
                        data-dismiss="modal">Confirmar</button>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Modal Editar Fim -->

              <!-- Modal Criar-->
              <div class="modal fade" id="inserirMarcacao" tabindex="-1" role="dialog" aria-labelledby="inserirMarcacao"
                aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLongTitle">Inserir Registro</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <div class="row">
                        <div class="col-md-12 p-0">
                          <div class="modal-container">
                            <div class="contact-form ">
                              <section>
                                <div class="container">
                                  <form method="post" #frm="ngForm" (ngSubmit)="criar(frm)">
                                    <div class="row">
                                      <div class="col-md-6 pb-2 pt-1">
                                        <label for="dataRegistro p-0">Data Registro</label>
                                        <input [(ngModel)]="ponto.dataRegistro" class="form-control" id="dataRegistro"
                                          name="dataRegistro" type="date" required>
                                      </div>
                                      <div class="col-md-6 pb-2 pt-1">
                                        <label for="horaRegistro">Hora Registro</label>
                                        <input [(ngModel)]="ponto.horaRegistro" class="form-control time-mask"
                                          id="horaRegistro" name="horaRegistro" type="time" required placeholder="00:00"
                                          minlength="5" maxlength="5" autocomplete="on">
                                      </div>
                                    </div>
                                    <div class="col-md-12 pt-1">
                                      <label for="justificaPonto">Justificativa</label>
                                      <select [(ngModel)]="ponto.justificaPonto" class="custom-select  form-control"
                                        id="justificaPonto" name="justificaPonto" placeholder="Justificativa"
                                        type="number" aria-controls="datatables-basic" required>
                                        <option value="">
                                          <font style="vertical-align: inherit;">
                                            <font style="vertical-align: inherit;"></font>
                                          </font>
                                        </option>
                                        <option value="1">
                                          <font style="vertical-align: inherit;">
                                            <font style="vertical-align: inherit;">Esquecimento</font>
                                          </font>
                                        </option>
                                        <option value="2">
                                          <font style="vertical-align: inherit;">
                                            <font style="vertical-align: inherit;">Trabalho Externo</font>
                                          </font>
                                        </option>
                                        <option value="3">
                                          <font style="vertical-align: inherit;">
                                            <font style="vertical-align: inherit;">Sistema Indisponível</font>
                                          </font>
                                        </option>
                                      </select>
                                    </div>
                                    <button type="submit" class="btn btn-success float-right  m-2"
                                      [disabled]="frm.invalid">Salvar</button>
                                    <button class="btn btn-secondary float-right  m-2"
                                      data-dismiss="modal">Fechar</button>
                                    <button type="submit" class="btn btn-success float-right  m-2"
                                      [disabled]="frm.invalid" data-dismiss="modal">Salvar e Fechar</button>
                                  </form>
                                </div>
                              </section>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>